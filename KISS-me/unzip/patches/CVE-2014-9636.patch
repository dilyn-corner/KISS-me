--- a/extract.c
+++ b/extract.c
@@ -2217,6 +2217,7 @@
     ulg eb_ucsize;
     uch *eb_ucptr;
     int r;
+    ush method;
 
     if (compr_offset < 4)                /* field is not compressed: */
         return PK_OK;                    /* do nothing and signal OK */
@@ -2232,6 +2233,13 @@
      ((eb_ucsize = makelong( eb+ (EB_HEADSIZE+ EB_UCSIZE_P))) == 0L) ||
      ((eb_ucsize > 0L) && (eb_size <= (compr_offset + EB_CMPRHEADLEN))))
         return IZ_EF_TRUNC;             /* no/bad compressed data! */
+
+    method = makeword(eb + (EB_HEADSIZE + compr_offset));
+    if ((method == STORED) &&
+            (eb_size - compr_offset - EB_CMPRHEADLEN != eb_ucsize))
+        return PK_ERR;                    /* compressed & uncompressed
+                                           * should match in STORED
+                                           * method */
 
     if (
 #ifdef INT_16BIT
