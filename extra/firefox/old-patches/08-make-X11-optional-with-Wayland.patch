--- a/toolkit/moz.configure
+++ b/toolkit/moz.configure
@@ -313,11 +313,6 @@
 def toolkit_gtk(toolkit):
     return toolkit == "gtk"
 
-
-set_config("MOZ_X11", True, when=toolkit_gtk)
-set_define("MOZ_X11", True, when=toolkit_gtk)
-add_old_configure_assignment("MOZ_X11", True, when=toolkit_gtk)
-
 # Wayland support
 # ==============================================================
 wayland_headers = pkg_check_modules(
@@ -337,6 +332,20 @@
 
 set_config("MOZ_WAYLAND", depends_if(wayland_headers)(lambda _: True))
 set_define("MOZ_WAYLAND", depends_if(wayland_headers)(lambda _: True))
+
+# X11 optional if Wayland is enabled
+# ==============================================================
+
+x11_headers = pkg_check_modules(
+        "MOZ_X11",
+        "gtk+-x11-3.0 >= 3.14",
+        allow_missing=depends(full_toolkit)(lambda t: t == "cairo-gtk3-wayland"),
+        when=toolkit_gtk,
+)
+
+set_config("MOZ_X11", depends_if(x11_headers)(lambda _: True))
+set_define("MOZ_X11", depends_if(x11_headers)(lambda _: true))
+add_old_configure_assignment("MOZ_X11", depends_if(x11_headers)(lambda _: True))
 
 # GL Provider
 # ==============================================================
