--- a/security/sandbox/linux/broker/SandboxBrokerPolicyFactory.cpp
+++ b/security/sandbox/linux/broker/SandboxBrokerPolicyFactory.cpp
@@ -39,7 +39,9 @@
 #  include <glib.h>
 #  ifdef MOZ_WAYLAND
 #    include <gdk/gdk.h>
-#    include <gdk/gdkx.h>
+#    ifdef MOZ_X11
+#     include <gdk/gdkx.h>
+#    endif
 #  endif
 #endif
 
@@ -503,7 +505,7 @@
     }
     policy->AddPath(SandboxBroker::MAY_CONNECT, bumblebeeSocket);
 
-#if defined(MOZ_WIDGET_GTK)
+#if defined(MOZ_WIDGET_GTK) && defined(MOZ_X11)
     // Allow local X11 connections, for Primus and VirtualGL to contact
     // the secondary X server. No exception for Wayland.
 #  if defined(MOZ_WAYLAND)
--- a/widget/gtk/nsUserIdleServiceGTK.h
+++ b/widget/gtk/nsUserIdleServiceGTK.h
@@ -9,9 +9,10 @@
 #define nsUserIdleServiceGTK_h__
 
 #include "nsUserIdleService.h"
-#include <X11/Xlib.h>
-#include <X11/Xutil.h>
-#include <gdk/gdkx.h>
+#ifdef MOZ_X11
+#   include <X11/Xlib.h>
+#   include <X11/Xutil.h>
+#   include <gdk/gdkx.h>
 
 typedef struct {
   Window window;               // Screen saver window
@@ -21,6 +22,7 @@
   unsigned long idle;          // milliseconds idle
   unsigned long event_mask;    // event stuff
 } XScreenSaverInfo;
+#endif /* MOZ_X11 */
 
 class nsUserIdleServiceGTK : public nsUserIdleService {
  public:
@@ -40,7 +42,9 @@
 
  private:
   ~nsUserIdleServiceGTK();
+#ifdef MOZ_X11
   XScreenSaverInfo* mXssInfo;
+#endif
 
  protected:
   nsUserIdleServiceGTK();
